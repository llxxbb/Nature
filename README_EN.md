# Nature

English|[中文](README.md)

## What is Nature？

It's a low code platform, it's a tool of data orchestration. But the most important is it goes right to the heart of the business, standardize and simplify the implementation of complex businesses in a simple way. As long as you're willing, Nature can help you extract the business control logic and centrally manage it so that the system has the brain and says goodbye to the brainless era of traditional systems. For its design philosophy, please see [Nature architecture](doc/EN/help/architecture.md), Nature has the following technical features:

### Distributed Stream-Compute-Engine

Traditional stream-compute is proposed to solve the timeliness of data processing, emphasizing calculation logic, and emphasizing `map-reduce`. Nature is also a stream-compute framework, and its core processing mode is: **Data--map--> Data--map-->Data...**, which simplifies `map-reduce` to `map` (It is not that `reduce` is discarded, but it can be embedded into `map` for processing). This simplified mode allows us to more easily focus on the data itself rather than the process, so **Nature emphasize data**, but not calculation logic. This point will be further explained below.

### Business Control Center

**Data--map--> Data--map--> Data** is **Nature's runtime mode**. From a management point of view, we pay more attention to results rather than processes, so Nature simplifies this mode further, the map is removed, and the new mode becomes: **Data-->Data-->Data...**. This is **Nature's design-time mode**. This also proves that Nature is a data-centric Stream-Compute-Engine.

Nature uses `Meta` and `Relation` to represent data and the relationship between them respectively. In this way, within Nature system, only Nature knows what business the data represents and how to find downstream businesses through `Relation` for all business systems involved in collaboration, so Nature becomes the actual business control center.

### Dispatching Center

The `map` in Nature runtime mode corresponds to the `Executor` in `Relation`. Nature will follow the data flow in the design-time mode to schedule Executor. These schedules include pre-processing, post-processing, idempotence, delay processing, timing processing, and batch processing. If it is timeout or encounters an abnormal environment, Nature will retry multiple times under the retry strategy, and try its best to ensure the final consistency of the data. Even if the final retry fails or a logical exception is encountered, Nature will not discard the task, but will put it in the error data table. After problem fixed, you can re-import the data from the error data table to the task data table, and Nature will retry these tasks again until they are successfully completed.

### Data Center

`Executor` generates `Instance` at runtime. The initial data submitted to Nature by the external system is also `Instance`. `Instance` is the runtime expression of `Meta`, which is also the instance data of the business. If you want, you can hand over as much `Meta` to Nature as possible. Nature will provide unified and centralized storage for the `Instance` generated by `Meta` and provide query interfaces for them, so that Nature will played the role of a Data Center. Here are a few notes:

- Data retrieval: Nature's business objects are all stored unstructured, much like the `Key-Value` database. If you want to perform statistics on the data in the business object. It can be convenient to utilize Nature’s Stream-Compute-Engine to process any data you want. Please refer to the demo of sales statistics in [Example](https://github.com/llxxbb/Nature-Demo).

- Database capacity: Nature uses mysql as the back-end storage by default. If you have a large amount of data, you can consider using [Tidb](https://pingcap.com/en/).

### Low Code Platform

You can see that Nature integrates many heavyweight elements, and the purpose of integration is to simplify our programming and enable developers to better focus on the business itself. It is embodied in the following aspects:

- Data driven
  Traditional function-oriented development will mix business data, technical data, control data, and temporary data together, creating unnecessary coupling, and unintentionally increasing the complexity and maintenance cost of the system; worse more, the key business Data may be "kidnapped" by the system, which becomes bloated, inefficient and difficult to change.
  Nature's design-time model is entirely composed of business data, without the smallest amount of function, which ensures the purity, intuitiveness and simplicity of the business, and can guarantee the absolute control of the business on the system. Nature's `Executor` divides the entire business system into the smallest collaborative units that are not coupled with each other, ensuring the simplicity of development and maintenance.

- Significantly reduce interface and storage related work

  Nature’s business process control is achieved through [Configuration](doc/EN/help/relation.md), and developers do not need to care about upstream and downstream process control issues. Reflected in two aspects: one is the definition of the interface, compared with the complex and a large number of personalized interface definitions in traditional projects, Nature only provides a limited number of interfaces; the other is the use of interfaces. Traditional projects need to write logic in the code for the calling of the interfaces, but for Nature, except submitting data to Nature, all interface calls are handled by Nature, which greatly simplifies interface-related design, development, debugging and follow-up maintenance work.

  Similarly, Nature adopts a centralized and unified data storage mechanism, and developers do not need to care about the design of data tables and indexes and subsequent development and maintenance work.

- Significantly reduce non-functional development related work

  Nature has done a lot of work for the availability (such as idempotence, eventual consistency of data) and reliability (such as retries, exception records) for the system. In addition, Nature also supports the business in terms of scalability , Such as the version technology of `Meta`. According to Pareto Principle (the 80/20 Rule), these 80% of the heavy and important work can now be undertaken by Nature.

## how to use

We need to do the following

1. Create a [mysql](https://www.mysql.com/) or [mariadb](https://mariadb.org/) or [Tidb](https://pingcap.com/en/) database , And execute [schema.sql](shell/schema.sql)

2. Define multiple business objects in the [Meta](doc/EN/help/meta.md) data table, for example: we define two business objects, `Order` and `Order Account`

   ```sql
   INSERT INTO meta (full_key, description, version, states, fields, config) VALUES
   ('B', 'sale/order', 'order', 1, '', '', ''),
   ('B', 'finance/orderAccount', 'order account', 1, 'unpaid|partial|paid', '', '{"master":"B:sale/order:1"}'); 
   ```

3. In the [relation](doc/EN/help/relation.md) data table, define the relationship to associate multiple business objects together, and set an `Executor` in the `Relation` for converting (equivalent to `map` in stream-compute), for example there is a definition for `order` and `order account` above:

   ```sql
   INSERT INTO relation
   (from_meta, to_meta, settings)
   VALUES('B:sale/order:1', 'B:finance/orderAccount:1', '{"executor":{"protocol":"localRust","url":"nature_demo:order_receivable"},"target":{"states":{"add":["unpaid"]}}}');
   ```

4. Write code to implement the [Executor](doc/EN/help/executor.md) you defined above. If it is based on Http, please start it after completion. If it is based on class library, please put it in the same directory as nature.exe. For example, the logic for `order` and `order account` is:

   - Generate an `order account` business object
   - Extract the receivables of all commodities from the incoming `order` and record them as the receivables of the `order account`
   - Return the `Order Account` object to Nature to drive the next step of processing

5. Configure the `DATABASE_URL` property in the `.env` file to point to the database you created

6. Start natrue.exe and retry.exe.

7. post request to Nature, such as submitting the `order` data to Nature, please refer to [Nature interface definition](doc/EN/help/nature-interface.md)

## Learn more about Nature

If you want to understand Nature's view of nature, time and space, mathematical meaning and philosophical meaning, please read: [Nature architecture](doc/EN/help/architecture.md)

If you want to learn how to apply Nature in actual situations read: [Sample and function explanation](https://github.com/llxxbb/Nature-Demo), [Solutions to some business scenarios](doc/EN/help/use-case.md)

If you want to know how Nature features technical features and how these features are implemented read: [Nature tecnology characteristics](doc/EN/help/characteristics.md)

If you want to understand differences between Nature and streaming computing, messaging systems, workflow etc. please read: [Compare with other framework](doc/EN/compare.md)

If you want to use Nature better, read: [Use Meta](doc/EN/help/meta.md), [Use Relation](doc/EN/help/relation.md), [Built-in executor](doc/EN/help/built-in.md)

## Note

The system is still in its early stage, especially the documentation needs to be continuously improved. If there are any improprieties, please provide more suggestions.